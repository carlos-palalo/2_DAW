/* Ejercicios Pag 16 */

SELECT * FROM ALUM0405;

SELECT DNI, NOMBRE, APELLIDOS, CURSO, NIVEL, CLASE FROM ALUM0405;

SELECT * FROM ALUM0405 WHERE POBLACION='GUADALAJARA';

SELECT NOMBRE, APELLIDOS FROM ALUM0405 POBLACION='GUADALAJARA';

SELECT DNI, NOMBRE, APELLIDOS, CURSO, NIVEL, CLASE FROM ALUM0405 ORDER BY APELLIDOS ASC, NOMBRE ASC;

/* Ejercicio 4 pag 17 */

SELECT DNOMBRE "Departamento", DEPT_NO "Número Departamento" FROM DEPART;

/* Ejercicio 5 pag 17 */

SELECT NOMBRE_ALUMNO "ALUMNO", (NOTA1+NOTA2+NOTA3)/3 "MEDIA" FROM NOTAS_ALUMNOS;

/* Ejercicio 6 pag 19 */
SELECT NOMBRE_ALUMNO FROM NOTAS_ALUMNOS WHERE NOTA2>NOTA1 AND NOTA3>(NOTA1+NOTA2+NOTA3)/3;

/* Ejercicio 11 Pag 25 */
SELECT OFICIO FROM EMPLE WHERE APELLIDO='GIL';

SELECT APELLIDO FROM EMPLE WHERE OFICIO=(SELECT OFICIO FROM EMPLE WHERE APELLIDO='GIL');

/* Ejercicio 4 Pag 26 */
SELECT APELLIDO, OFICIO, SALARIO, FECHA_ALT 
FROM EMPLE 
WHERE OFICIO = (SELECT OFICIO FROM EMPLE WHERE APELLIDO='JIMENEZ')
OR SALARIO >= (SELECT SALARIO FROM EMPLE WHERE APELLIDO='FERNANDEZ');

/* Ejemplo Pag 26 */
SELECT APELLIDO FROM EMPLE WHERE OFICIO IN (SELECT DISTINCT OFICIO FROM EMPLE WHERE DEPT_NO=20);

SELECT * FROM DEPART WHERE NOT EXISTS (SELECT
* FROM EMPLE WHERE EMPLE.DEPT_NO= DEPART.DEPT_NO);

SELECT DNOMBRE, DEPT_NO FROM DEPART WHERE EXISTS (SELECT
* FROM EMPLE WHERE EMPLE.DEPT_NO= DEPART.DEPT_NO);

/* Ejemplo Pag 28 */
SELECT DEPT_NO FROM DEPART WHERE LOC IN ('MADRID', 'BARCELONA');

SELECT * FROM EMPLE WHERE DEPT_NO != ALL 
(SELECT DEPT_NO FROM DEPART WHERE LOC IN ('MADRID', 'BARCELONA'));

SELECT * FROM EMPLE WHERE DEPT_NO NOT IN
(SELECT DEPT_NO FROM DEPART WHERE LOC IN ('MADRID', 'BARCELONA'));

SELECT APELLIDO, OFICIO FROM EMPLE WHERE DEPT_NO=20 
AND OFICIO IN (SELECT OFICIO FROM EMPLE WHERE DEPT_NO=
(SELECT DEPT_NO FROM DEPART WHERE DNOMBRE='VENTAS'));

SELECT APELLIDO, OFICIO FROM EMPLE WHERE DEPT_NO=20 
AND OFICIO IN 
(SELECT OFICIO FROM EMPLE E, DEPART D 
WHERE E.DEPT_NO=D.DEPT_NO AND D.DNOMBRE='VENTAS');

SELECT APELLIDO, SALARIO FROM EMPLE WHERE (OFICIO, SALARIO) =
(SELECT OFICIO, SALARIO FROM EMPLE WHERE APELLIDO ='GIL');

SELECT APELLIDO, SALARIO FROM EMPLE
WHERE OFICIO= (SELECT OFICIO FROM EMPLE WHERE APELLIDO ='GIL')
AND SALARIO= (SELECT SALARIO FROM EMPLE WHERE APELLIDO ='GIL');

SELECT * FROM EMPLE E WHERE SALARIO = 
(SELECT MAX(SALARIO) FROM EMPLE E1 WHERE E.DEPT_NO = E1.DEPT_NO) ORDER BY SALARIO;

SELECT E.APELLIDO, E.OFICIO, E.SALARIO, D.DEPT_NO, D.DNOMBRE
FROM EMPLE E, DEPART D WHERE E.DEPT_NO=D.DEPT_NO;

SELECT APELLIDO, OFICIO, EMP_NO, DNOMBRE, LOC FROM EMPLE, DEPART
WHERE EMPLE.DEPT_NO = DEPART.DEPT_NO;

SELECT AL.APENOM, AL.DNI, N.NOTA, ASI.NOMBRE 
FROM ALUMNOS AL, ASIGNATURAS ASI, NOTAS N
WHERE AL.DNI=N.DNI AND N.COD=ASI.COD;

SELECT * FROM ALUMNOS A, NOTAS N, ASIGNATURAS ASIG
WHERE A.DNI=N.DNI AND N.COD=ASIG.COD AND N.NOTA BETWEEN 7 AND 8 AND ASIG.NOMBRE='FOL';

SELECT DISTINCT ASIG.NOMBRE FROM NOTAS N, ASIGNATURAS ASIG
WHERE N.COD=ASIG.COD AND N.NOTA>=5;

SELECT ASIG.NOMBRE FROM NOTAS N, ASIGNATURAS ASIG
WHERE N.COD=ASIG.COD AND N.NOTA<5;

/******************************** Actividades complementarias ********************************+/

/* 1 */
SELECT E.APELLIDO, E.OFICIO, D.LOC
FROM DEPART D, EMPLE E
WHERE E.DEPT_NO=D.DEPT_NO AND E.OFICIO='ANALISTA';

/* 2 */
SELECT * FROM EMPLE WHERE DIR=(SELECT EMP_NO FROM EMPLE WHERE APELLIDO='CEREZO');

/* 3 */
SELECT * FROM EMPLE WHERE DEPT_NO=(SELECT DEPT_NO FROM DEPART WHERE DNOMBRE='VENTAS');

/* 4 */
SELECT * FROM DEPART WHERE DEPT_NO NOT IN (SELECT DISTINCT DEPT_NO FROM EMPLE);

/* 5 */
SELECT * FROM DEPART WHERE DEPT_NO IN (SELECT DISTINCT DEPT_NO FROM EMPLE);

/* 6 */
SELECT APELLIDO, SALARIO FROM EMPLE WHERE SALARIO>ALL (SELECT SALARIO FROM EMPLE WHERE DEPT_NO=20);

/* 7 */
SELECT TEMA, ESTANTE, EJEMPLARES FROM LIBRERIA WHERE EJEMPLARES BETWEEN 8 AND 15;

/* 8 */
SELECT TEMA, ESTANTE, EJEMPLARES FROM LIBRERIA WHERE ESTANTE NOT BETWEEN 'B' AND 'D';

/* 9 */
SELECT TEMA FROM LIBRERIA 
WHERE EJEMPLARES < ALL (SELECT EJEMPLARES 
FROM LIBRERIA WHERE TEMA='MEDICINA');

/* 10 */
SELECT TEMA FROM LIBRERIA WHERE EJEMPLARES NOT BETWEEN 15 AND 20;

/* 11 */
SELECT * FROM ASIGNATURAS ASIG, NOTAS N, ALUMNOS A
WHERE ASIG.COD=N.COD AND N.DNI=A.DNI AND
ASIG.NOMBRE LIKE '%o%o%o%' AND A.POBLA='Madrid';

/* 12 */
SELECT A.APENOM FROM NOTAS N, ALUMNOS A
WHERE N.NOTA<5 AND A.POBLA='Madrid';

/* 13 */
SELECT DISTINCT A.APENOM, N.NOTA FROM NOTAS N, ALUMNOS A 
WHERE A.DNI=N.DNI AND NOTA=(SELECT N.NOTA 
FROM ASIGNATURAS ASIG, ALUMNOS A, NOTAS N 
WHERE ASIG.NOMBRE='FOL' AND A.APENOM='Díaz Fernández, María' 
AND ASIG.COD=N.COD AND A.DNI=N.DNI);

/* 14 */
SELECT * FROM ASIGNATURAS WHERE

/* EJERCICIOS DICTADOS */
SELECT * FROM LIBRERIA WHERE TEMA LIKE '%IA%';

SELECT * FROM LIBRERIA WHERE TEMA LIKE '_I%O%';

INSERT INTO ALUMNOS VALUES(45,'PÉREZ GARCÍA, PEPE','','','');
INSERT INTO ALUMNOS VALUES(56,'ESPAÑOL ESPAÑOL, JUAN', 'C/ CASA', 'TORDESILLAS','');

SELECT * FROM ALUMNOS WHERE POBLA!='MADRID' AND TELEF IS NULL AND DIREC IS NOT NULL;

SELECT * FROM EMPLE WHERE OFICIO IN('ANALISTA','VENDEDOR') AND DEPT_NO NOT IN(10,20);

SELECT * FROM EMPLE WHERE SALARIO BETWEEN 1340 AND 2900;

SELECT * FROM EMPLE WHERE SALARIO NOT BETWEEN 1500 AND 3000 AND DIR IS NULL;

SELECT * FROM ALUMNOS WHERE DNI LIKE '4%' AND (POBLA IN('Madrid','Móstoles') OR POBLA IS NULL);

/**************************** Ejemplos Archivo 4.5 *********************************/

SELECT D.DNOMBRE, D.DEPT_NO, SUM(E.SALARIO), AVG(E.SALARIO), COUNT(*), MAX(SALARIO), MIN(SALARIO)
FROM EMPLE E, DEPART D 
WHERE D.DEPT_NO=E.DEPT_NO 
GROUP BY D.DNOMBRE, D.DEPT_NO; 

SELECT NOMBRE
FROM ASIGNATURAS AG, NOTAS N
WHERE AG.COD=N.COD
AND N.NOTA>5
GROUP BY NOMBRE
ORDER BY NOMBRE;

SELECT DEPT_NO "Nº DEPT", COUNT(*) "Nº EMPL" 
FROM EMPLE GROUP BY DEPT_NO;

SELECT DNOMBRE "NOMBRE DEPT", D.DEPT_NO "Nº DEPT", COUNT(*) "Nº EMPL"
FROM EMPLE E, DEPART D 
WHERE E.DEPT_NO=D.DEPT_NO GROUP BY D.DEPT_NO, DNOMBRE
HAVING D.DEPT_NO=10 OR D.DEPT_NO=20;

SELECT DNOMBRE "NOMBRE DEPT", D.DEPT_NO "Nº DEPT", COUNT(*) "Nº EMPL"
FROM EMPLE E, DEPART D 
WHERE E.DEPT_NO=D.DEPT_NO GROUP BY D.DEPT_NO, DNOMBRE
HAVING COUNT(*)>4;

SELECT D.DEPT_NO, DNOMBRE, AVG(E.SALARIO) "MEDIA DEPART", 
(SELECT AVG(SALARIO) FROM EMPLE) "MEDIA TOTAL" 
FROM EMPLE E, DEPART D
WHERE E.DEPT_NO=D.DEPT_NO 
GROUP BY D.DEPT_NO, DNOMBRE
HAVING AVG(E.SALARIO)>=(SELECT AVG(SALARIO) FROM EMPLE);

SELECT DEPT_NO, COUNT(*) FROM EMPLE
GROUP BY DEPT_NO
HAVING COUNT(*)>4
ORDER BY COUNT(*) DESC;

SELECT DEPT_NO, OFICIO, COUNT(*) FROM EMPLE GROUP BY DEPT_NO, OFICIO ORDER BY DEPT_NO, OFICIO;

SELECT NOMBRE "DEPARTAMENTO", AVG(NOTA) "MEDIA"
FROM NOTAS N, ASIGNATURAS A WHERE N.COD=A.COD
GROUP BY NOMBRE HAVING AVG(NOTA)>6
ORDER BY NOMBRE;

SELECT D.DEPT_NO, DNOMBRE, COUNT(E.EMP_NO)
FROM EMPLE E, DEPART D
WHERE E.DEPT_NO(+)=D.DEPT_NO
GROUP BY D.DEPT_NO, DNOMBRE
ORDER BY D.DEPT_NO;

SELECT D.DEPT_NO, DNOMBRE, COUNT(E.EMP_NO)
FROM EMPLE E RIGHT JOIN DEPART D
ON E.DEPT_NO=D.DEPT_NO
GROUP BY D.DEPT_NO, DNOMBRE
ORDER BY D.DEPT_NO;

SELECT D.DEPT_NO, DNOMBRE, COUNT(E.EMP_NO)
FROM EMPLE E RIGHT JOIN DEPART D
ON E.DEPT_NO=D.DEPT_NO
GROUP BY D.DEPT_NO, DNOMBRE
ORDER BY D.DEPT_NO;


SELECT AG.COD, AG.NOMBRE, SUM(NOTA) "SUMA", COUNT(NOTA) "Nº NOTAS" 
FROM NOTAS N FULL OUTER JOIN ASIGNATURAS AG
ON N.COD=AG.COD
GROUP BY AG.COD, AG.NOMBRE
ORDER BY AG.COD;


SELECT DNI, DIRECCION, POBLACION, PROVINCIA FROM ALUM0405
UNION
SELECT DNI, DIREC, POBLA, TELEF FROM ALUMNOS;